local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")


local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AnimFreezeUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.DisplayOrder = 9999
screenGui.Parent = playerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 44)
frame.Position = UDim2.new(0, 10, 0, 10)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 2
frame.BorderColor3 = Color3.fromRGB(100, 100, 255)
frame.Active = true
frame.Draggable = true
frame.ZIndex = 9999
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = frame

local textLabel = Instance.new("TextLabel")
textLabel.Size = UDim2.new(0, 130, 1, 0)
textLabel.Position = UDim2.new(0, 12, 0, 0)
textLabel.BackgroundTransparency = 1
textLabel.Text = "No Animation"
textLabel.TextColor3 = Color3.new(1,1,1)
textLabel.Font = Enum.Font.GothamBold
textLabel.TextSize = 18
textLabel.TextXAlignment = Enum.TextXAlignment.Left
textLabel.ZIndex = 9999
textLabel.Parent = frame

local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 60, 0, 30)
toggleBtn.Position = UDim2.new(1, -70, 0.5, -15)
toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
toggleBtn.Text = "OFF"
toggleBtn.TextColor3 = Color3.new(0,0,0)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 16
toggleBtn.AutoButtonColor = false
toggleBtn.ZIndex = 9999
toggleBtn.Parent = frame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 8)
btnCorner.Parent = toggleBtn

local hue = 0
RunService.Heartbeat:Connect(function(dt)
	hue = (hue + dt * 0.2) % 1
	textLabel.TextColor3 = Color3.fromHSV(hue, 1, 1)
end)

local frozenTransforms = {}
local motors = {}
local connection
local currentAnimateScript
local isFrozen = false

local function getCharacter()
	local char = player.Character
	if char then
		local anim = char:FindFirstChild("Animate")
		if anim then return char, anim end
	end
	return nil, nil
end

local function collectMotors(char)
	table.clear(motors)
	for _, v in char:GetDescendants() do
		if v:IsA("Motor6D") and v.Part0 and v.Part1 then
			table.insert(motors, v)
		end
	end
end

local function freezePose()
	local char, animateScript = getCharacter()
	if not char or not animateScript then return end
	
	currentAnimateScript = animateScript
	collectMotors(char)
	table.clear(frozenTransforms)
	for _, m in motors do
		frozenTransforms[m] = m.Transform
	end
	
	animateScript.Disabled = true

	if connection then connection:Disconnect() end
	connection = RunService.RenderStepped:Connect(function()
		local stillValidChar, stillValidAnimate = getCharacter()
		if not stillValidChar or stillValidAnimate ~= currentAnimateScript then 
			setState(false)
			return 
		end
		
		for m, tr in frozenTransforms do
			if m.Parent then m.Transform = tr end
		end
	end)
end

local function unfreezePose()
	if currentAnimateScript then
		currentAnimateScript.Disabled = false
		currentAnimateScript = nil
	end
	if connection then connection:Disconnect() connection = nil end
	table.clear(frozenTransforms)
	table.clear(motors)
end

local function setState(on)
	isFrozen = on
	if on then
		freezePose()
		toggleBtn.Text = "ON"
		toggleBtn.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
	else
		unfreezePose()
		toggleBtn.Text = "OFF"
		toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
	end
end

toggleBtn.MouseButton1Click:Connect(function()
	setState(not isFrozen)
end)

player.CharacterAdded:Connect(function()
	if isFrozen then setState(false) end
end)

setState(false)

print("SCRIPT LOADED")
